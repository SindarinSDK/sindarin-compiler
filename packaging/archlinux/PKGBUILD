# Maintainer: Sindarin Project <https://github.com/RealOrko/sindarin>
# Arch Linux PKGBUILD for Sindarin
# Install with: makepkg -si

pkgname=sindarin
pkgver=${VERSION}
pkgrel=1
pkgdesc="A statically-typed procedural language that compiles to C"
arch=('x86_64')
url="https://github.com/RealOrko/sindarin"
license=('MIT')
depends=('gcc' 'zlib')
source=("https://github.com/RealOrko/sindarin/releases/download/${TAG}/sindarin-${TAG}-linux-x64.tar.gz")
sha256sums=('${SHA256}')

package() {
    cd "$srcdir/sindarin-${TAG}-linux-x64"

    # Install binary
    install -Dm755 bin/sn "$pkgdir/usr/bin/sn"

    # Install config
    install -Dm644 etc/sindarin/sn.cfg "$pkgdir/etc/sindarin/sn.cfg"

    # Install runtime libraries
    install -dm755 "$pkgdir/usr/lib/sindarin"
    cp -r lib/sindarin/* "$pkgdir/usr/lib/sindarin/"

    # Install headers
    install -dm755 "$pkgdir/usr/include/sindarin"
    cp -r include/sindarin/* "$pkgdir/usr/include/sindarin/"

    # Install SDK standard library
    install -dm755 "$pkgdir/usr/share/sindarin/sdk"
    cp -r share/sindarin/sdk/* "$pkgdir/usr/share/sindarin/sdk/"

    # Install license
    install -Dm644 LICENSE "$pkgdir/usr/share/licenses/$pkgname/LICENSE" 2>/dev/null || true
}
