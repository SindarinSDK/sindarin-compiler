// Code Generation Test: Global with private function
//
// Tests that a private function creates its own private arena for allocations,
// can read global string variables from __main_arena__, and can modify
// global handles using __main_arena__ for the mutation.

var greeting: str = "Hello"
var message: str = ""

private fn process_greeting(): int =>
    // private function uses its own private arena (__local_arena__)
    // global 'greeting' is in __main_arena__, accessed via parent-walking
    // Mutating 'message' should use __main_arena__ since it's a global
    message = greeting + " World"
    return len(greeting)

fn main(): int =>
    println("Global with private function test:")
    var result: int = process_greeting()
    println(message)
    println($"Greeting length: {result}")
    println("PASS")
    return 0
