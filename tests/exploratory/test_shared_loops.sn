// Test 41: Shared loops
fn main(): int =>
    print("Test shared loops:\n\n")

    // Shared for loop
    print("Shared for loop:\n")
    var sum1: int = 0
    shared for var i: int = 0; i < 5; i++ =>
        sum1 = sum1 + i
    print($"Sum from shared for: {sum1}\n")

    // Shared while loop
    print("\nShared while loop:\n")
    var count: int = 0
    shared while count < 5 =>
        print($"  count = {count}\n")
        count++
    print($"Final count: {count}\n")

    // Shared for-each loop
    print("\nShared for-each loop:\n")
    var arr: int[] = {10, 20, 30, 40, 50}
    var sum2: int = 0
    shared for n in arr =>
        sum2 = sum2 + n
    print($"Sum from shared for-each: {sum2}\n")

    // Shared nested loops
    print("\nShared nested loops:\n")
    var total: int = 0
    shared for var i: int = 1; i <= 3; i++ =>
        shared for var j: int = 1; j <= 3; j++ =>
            total = total + i * j
    print($"Total from nested: {total}\n")

    // Compare shared vs regular (check arena behavior)
    print("\nShared vs regular loop:\n")
    var sum3: int = 0
    shared for var k: int = 0; k < 3; k++ =>
        sum3 = sum3 + k
    print($"Shared sum: {sum3}\n")

    var sum4: int = 0
    for var m: int = 0; m < 3; m++ =>
        sum4 = sum4 + m
    print($"Regular sum: {sum4}\n")

    // Shared for-each with string array
    print("\nShared for-each with strings:\n")
    var names: str[] = {"Alice", "Bob", "Charlie"}
    shared for name in names =>
        print($"  Hello, {name}!\n")

    return 0
