# Exploratory test: 2D arrays with any type

struct Point =>
    x: double
    y: double

fn main(): int =>
    # Test 1: 2D array of ints boxed into any
    var matrix: int[][] = {{1, 2, 3}, {4, 5, 6}, {7, 8, 9}}
    var a: any = matrix

    print("Test 1: 2D int array boxed to any\n")
    if a is int[][] =>
        print("  a is int[][]: PASS\n")
        var m: int[][] = a as int[][]
        print($"  m[1][1] = {m[1][1]}\n")
        if m[1][1] == 5 =>
            print("  Value check: PASS\n")
        else =>
            print("  Value check: FAIL\n")
            return 1
    else =>
        print("  a is int[][]: FAIL\n")
        return 1

    # Test 2: 2D any array with mixed types
    print("\nTest 2: 2D any array with mixed types\n")
    var mixed: any[][] = {{1, "hello"}, {true, 3.14}}
    print($"  mixed[0][0] = {mixed[0][0] as int}\n")
    print($"  mixed[0][1] = {mixed[0][1] as str}\n")
    print($"  mixed[1][0] = {mixed[1][0] as bool}\n")
    print($"  mixed[1][1] = {mixed[1][1] as double}\n")

    # Test 3: any[] containing 1D arrays
    print("\nTest 3: any[] containing 1D arrays\n")
    var arr1: int[] = {1, 2, 3}
    var arr2: str[] = {"a", "b", "c"}
    var container: any[] = {arr1, arr2}

    if container[0] is int[] =>
        print("  container[0] is int[]: PASS\n")
        var ints: int[] = container[0] as int[]
        print($"  ints[0] = {ints[0]}\n")
    else =>
        print("  container[0] is int[]: FAIL\n")
        return 1

    if container[1] is str[] =>
        print("  container[1] is str[]: PASS\n")
        var strs: str[] = container[1] as str[]
        print($"  strs[0] = {strs[0]}\n")
    else =>
        print("  container[1] is str[]: FAIL\n")
        return 1

    print("\nAll tests passed!\n")
    return 0
