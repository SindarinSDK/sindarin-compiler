# Debug test for array access in loops

fn main(): int =>
    print("=== Debug Array Access ===\n\n")

    # Test 1: Simple string comparison
    print("Test 1: Direct string comparison\n")
    var a: str = "alpha"
    var b: str = "beta"
    print($"Comparing '{a}' with '{b}':\n")
    var cmp: int = _strcmp(a, b)
    print($"Result: {cmp} (expected: -1)\n\n")

    # Test 2: String array access
    print("Test 2: Array element access\n")
    var arr: str[] = {"alpha", "beta", "gamma"}
    print($"arr[0] = '{arr[0]}'\n")
    print($"arr[1] = '{arr[1]}'\n")
    print($"arr[2] = '{arr[2]}'\n\n")

    # Test 3: Split and access
    print("Test 3: Split and access\n")
    var input: str = "alpha.beta"
    var parts: str[] = input.split(".")
    print($"parts.length = {parts.length}\n")
    print($"parts[0] = '{parts[0]}'\n")
    print($"parts[1] = '{parts[1]}'\n\n")

    # Test 4: Loop over split result
    print("Test 4: Loop over split result\n")
    var i: int = 0
    while i < parts.length =>
        var elem: str = parts[i]
        print($"  parts[{i}] = '{elem}' (len={elem.length})\n")
        i = i + 1
    print("\n")

    # Test 5: Two arrays in loop
    print("Test 5: Two split arrays in loop\n")
    var s1: str = "alpha"
    var s2: str = "beta"
    var p1: str[] = s1.split(".")
    var p2: str[] = s2.split(".")
    print($"p1.length = {p1.length}, p2.length = {p2.length}\n")

    # Workaround to pin
    var _dummy1: int = p1[0].length
    var _dummy2: int = p2[0].length

    var minLen: int = p1.length
    if p2.length < minLen =>
        minLen = p2.length

    var j: int = 0
    while j < minLen =>
        var pa: str = p1[j]
        var pb: str = p2[j]
        print($"  p1[{j}] = '{pa}', p2[{j}] = '{pb}'\n")
        j = j + 1

    return 0

fn _strcmp(a: str, b: str): int =>
    var minLen: int = a.length
    if b.length < minLen =>
        minLen = b.length
    var i: int = 0
    while i < minLen =>
        var ca: int = a.charAt(i) as int
        var cb: int = b.charAt(i) as int
        if ca < cb =>
            return -1
        if ca > cb =>
            return 1
        i = i + 1
    if a.length < b.length =>
        return -1
    if a.length > b.length =>
        return 1
    return 0
